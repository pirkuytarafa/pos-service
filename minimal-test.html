<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Minimal Test - Firebase + React</title>
    <style>
        body { 
            font-family: system-ui; 
            padding: 20px; 
            background: #0f172a; 
            color: white; 
        }
        .log { 
            background: #1e293b; 
            padding: 12px; 
            margin: 8px 0; 
            border-radius: 6px; 
            border-left: 4px solid #3b82f6;
        }
        .error { border-left-color: #ef4444; background: #7f1d1d; }
        .success { border-left-color: #10b981; background: #064e3b; }
    </style>
</head>
<body>
    <h1>üîç Minimal Test</h1>
    <div id="logs"></div>
    <div id="root"></div>

    <script>
        const log = (msg, type = 'log') => {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = new Date().toLocaleTimeString() + ' - ' + msg;
            document.getElementById('logs').appendChild(div);
            console.log(msg);
        };

        window.onerror = (msg, source, line, col, error) => {
            log('ERROR: ' + msg + ' at ' + source + ':' + line, 'error');
            return false;
        };

        log('Starting test...', 'log');
    </script>

    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.3.1",
        "react-dom/client": "https://esm.sh/react-dom@18.3.1/client",
        "firebase/app": "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js"
      }
    }
    </script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js" 
            onload="log('Babel loaded', 'success')" 
            onerror="log('Babel FAILED', 'error')">
    </script>

    <script type="text/babel" data-type="module">
        (async () => {
            try {
                log('Importing React...');
                const React = await import('react');
                log('‚úÖ React ' + React.version, 'success');
                
                log('Importing ReactDOM...');
                const ReactDOM = await import('react-dom/client');
                log('‚úÖ ReactDOM loaded', 'success');
                
                log('Importing Firebase...');
                const { initializeApp } = await import('firebase/app');
                const { getAuth } = await import('firebase/auth');
                const { getFirestore } = await import('firebase/firestore');
                log('‚úÖ Firebase modules loaded', 'success');
                
                log('Initializing Firebase...');
                const app = initializeApp({
                    apiKey: "AIzaSyAF9msg6MbCPuyB2iJ1yXkUrQYTgG_H5EM",
                    authDomain: "ifix-enterprise.firebaseapp.com",
                    projectId: "ifix-enterprise",
                    storageBucket: "ifix-enterprise.firebasestorage.app",
                    messagingSenderId: "954001235629",
                    appId: "1:954001235629:web:0cf28c5eeff9041e3ff024"
                });
                log('‚úÖ Firebase initialized: ' + app.name, 'success');
                
                const auth = getAuth(app);
                const db = getFirestore(app);
                log('‚úÖ Auth & Firestore ready', 'success');
                
                // Test React render
                log('Testing React render...');
                const { useState } = React;
                const { createRoot } = ReactDOM;
                
                function TestApp() {
                    const [count, setCount] = useState(0);
                    return React.createElement('div', { 
                        style: { 
                            background: 'white', 
                            color: 'black', 
                            padding: '20px', 
                            borderRadius: '8px',
                            marginTop: '20px'
                        }
                    }, [
                        React.createElement('h2', { key: 'title' }, '‚úÖ React is Working!'),
                        React.createElement('p', { key: 'count' }, 'Count: ' + count),
                        React.createElement('button', { 
                            key: 'btn',
                            onClick: () => setCount(count + 1),
                            style: {
                                background: '#3b82f6',
                                color: 'white',
                                padding: '8px 16px',
                                border: 'none',
                                borderRadius: '4px',
                                cursor: 'pointer'
                            }
                        }, 'Click Me')
                    ]);
                }
                
                const root = createRoot(document.getElementById('root'));
                root.render(React.createElement(TestApp));
                log('‚úÖ React render SUCCESS!', 'success');
                
                log('üéâ ALL TESTS PASSED!', 'success');
                
            } catch (err) {
                log('‚ùå ERROR: ' + err.message, 'error');
                log('Stack: ' + err.stack, 'error');
            }
        })();
    </script>
</body>
</html>
